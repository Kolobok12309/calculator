var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function s(t){return null==t?"":t}function a(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}t.selectedIndex=-1}function w(t,e,n){t.classList[n?"add":"remove"](e)}let x;function b(t){x=t}function y(){const t=function(){if(!x)throw new Error("Function called outside component initialization");return x}();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}const k=[],_=[],E=[],A=[],S=Promise.resolve();let j=!1;function D(t){E.push(t)}let C=!1;const V=new Set;function M(){if(!C){C=!0;do{for(let t=0;t<k.length;t+=1){const e=k[t];b(e),R(e.$$)}for(b(null),k.length=0;_.length;)_.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];V.has(e)||(V.add(e),e())}E.length=0}while(k.length);for(;A.length;)A.pop()();j=!1,C=!1,V.clear()}}function R(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(D)}}const L=new Set;function O(t,e){t&&t.i&&(L.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(L.has(t))return;L.add(t),undefined.c.push((()=>{L.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function q(t){t&&t.c()}function T(t,n,c,i){const{fragment:s,on_mount:a,on_destroy:l,after_update:u}=t.$$;s&&s.m(n,c),i||D((()=>{const n=a.map(e).filter(o);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(D)}function B(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(t,e){-1===t.$$.dirty[0]&&(k.push(t),j||(j=!0,S.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function I(e,o,c,i,s,a,l,h=[-1]){const d=x;b(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:o.target||d.$$.root};l&&l(f.root);let p=!1;if(f.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&N(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!i&&i(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();o.intro&&O(e.$$.fragment),T(e,o.target,o.anchor,o.customElement),M()}b(d)}class F{$destroy(){B(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const P=[];var W;!function(t){t.Dark="dark",t.Light="light",t.Default="default"}(W||(W={}));const G="color-theme",H=window.localStorage,J=(K=W,t=>Object.values(K).includes(t));var K;const Q=(()=>{let e=W.Default;try{const t=H.getItem(G);J(t)&&(e=t)}catch(t){}const{subscribe:n,set:r}=function(e,n=t){let r;const o=new Set;function i(t){if(c(e,t)&&(e=t,r)){const t=!P.length;for(const t of o)t[1](),P.push(t,e);if(t){for(let t=0;t<P.length;t+=2)P[t][0](P[t+1]);P.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(c,s=t){const a=[c,s];return o.add(a),1===o.size&&(r=n(i)||t),c(e),()=>{o.delete(a),0===o.size&&(r(),r=null)}}}}(e,(t=>{const e=({storageArea:e,key:n,newValue:r})=>{e===H&&n===G&&J(r)&&t(r)};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}));return{subscribe:n,set:t=>{let e=W.Default;J(t)&&(e=t);try{H.setItem(G,e),r(e)}catch(t){}}}})();class U{constructor({token:t,priority:e=0,oneArgument:n=!1,view:r,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=n,this.calc=o,r)this.view=r;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const r=e?t[0]:t;this.view=n?t=>`${t}${r}`:(t,e)=>`${t} ${r} ${e}`}}}var X=new U({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),Y=new U({token:"+",calc:(t,e)=>t+e}),Z=new U({token:"-",calc:(t,e)=>t-e}),tt=new U({token:"*",priority:5,calc:(t,e)=>t*e}),et=new U({token:"/",priority:5,calc:(t,e)=>t/e}),nt=new U({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),rt=new U({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const ot=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*ot(t-1)};var ct=new U({token:"!",priority:10,oneArgument:!0,calc:ot,view:t=>`${t}!`});const it=[Y,Z,tt,et,nt,rt,ct];class st{constructor(t,e,n){if(this.operator=t,this.v1=e,this.v2=n,!t.oneArgument&&void 0===n)throw new Error(`Operator "${t.token}" require two arguments`)}getMaxDepth(){const t=this.v1 instanceof st?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof st?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof st){const e=this.v1.operator.priority<this.operator.priority,n=this.v1.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof st){const e=this.v2.operator.priority<this.operator.priority,n=this.v2.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const n=this.getV2View(t);return this.operator.view(e,n)}exec(){if(this.result)return this.result;const t=this.v1 instanceof st?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof st?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const at=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class lt{constructor({operators:t=it}={}){this.operators=t}getMatchRegex(){const t=[{matcher:this.operators.reduce(((t,{token:e})=>t.concat(e)),[]).map(at).join("|"),name:"operator"},{matcher:lt.numberRegexpString,name:"number"},{matcher:lt.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(t,"g")}static validateBrackets(t){const e=t.match(new RegExp(lt.bracketsRegexpString,"g"));if(!e)return!0;let n=0;return e.forEach((t=>{")"===t?n--:n++})),0===n}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=((t,e)=>{const n=[];let r;for(;r=t.exec(e);)n.push(r);return n})(this.getMatchRegex(),t),n=[];let r=0;return e.forEach((({groups:t},o)=>{const{number:c,bracket:i,operator:s}=t,a=e[o-1],l=e[o+1];if(i)")"===i?r-=100:"("===i&&(a&&a.groups.number&&n.push({operator:tt,priority:r+tt.priority}),r+=100);else if(s)if("+"!==s&&"-"!==s||a&&!(a&&a.groups.operator&&l&&l.groups.number)){const t=this.getOperatorByToken(s);n.push({operator:t,priority:r+t.priority})}else l.groups.number=`${s}${l.groups.number}`;else if(c){const{groups:{bracket:t=null}={}}=a||{};")"===t&&n.push({operator:tt,priority:r+tt.priority}),n.push(parseFloat(c.replace(",",".")))}})),n}compile(t=""){if(!lt.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),n=e.filter((t=>"number"!=typeof t)),r=e.slice();if(n.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:n}=t,o=r.indexOf(t),c=r[o-1];if(c&&"number"!=typeof c&&!(c instanceof st)){const{operator:{token:t}}=c;throw new Error(`Two operators in a row 1:"${t}", 2:"${e.token}"`)}if(e.oneArgument)r.splice(o-1,2,new st(e,c));else{const t=r[o+1];if(t&&"number"!=typeof t&&!(t instanceof st)){const{operator:{token:n}}=t;throw new Error(`Two operators in a row 1:"${e.token}", 2:"${n}"`)}r.splice(o-1,3,new st(e,c,t))}})),r.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!r.length)throw new Error("No operators");const o=r[0];return"number"==typeof o?new st(X,o):o}calc(t=""){return this.compile(t).exec()}}function ut(t,e,n){const r=t.slice();return r[2]=e[n],r}function ht(t){let e,n,r,o,c,i,h=t[2].text+"";return{c(){e=d("button"),n=f(h),r=p(),m(e,"class",o=s(`keyboard__btn keyboard__btn_${t[2].color}`)+" svelte-fflyre"),w(e,"keyboard__btn_round",t[2].round)},m(o,s){l(o,e,s),a(e,n),a(e,r),c||(i=g(e,"click",t[2].handler),c=!0)},p(e,n){t=e},d(t){t&&u(e),c=!1,i()}}}function dt(e){let n,r=e[0],o=[];for(let t=0;t<r.length;t+=1)o[t]=ht(ut(e,r,t));return{c(){n=d("div");for(let t=0;t<o.length;t+=1)o[t].c();m(n,"class","keyboard svelte-fflyre")},m(t,e){l(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){if(1&e){let c;for(r=t[0],c=0;c<r.length;c+=1){const i=ut(t,r,c);o[c]?o[c].p(i,e):(o[c]=ht(i),o[c].c(),o[c].m(n,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:t,o:t,d(t){t&&u(n),h(o,t)}}}function ft(t){const e=y();return[[{text:"C",color:"red",handler:()=>e("reset")},{text:"CA",color:"red",handler:()=>e("reset")},{text:"CA",color:"red",handler:()=>e("reset")},{text:"CA",color:"red",handler:()=>e("reset")},{text:"(",color:"accent",handler:()=>e("add",")")},{text:")",color:"accent",handler:()=>e("add","(")},{text:"!",color:"accent",handler:()=>e("add","!")},{text:"/",color:"accent",handler:()=>e("add","/")},{text:"7",color:"text",handler:()=>e("add","7")},{text:"8",color:"text",handler:()=>e("add","8")},{text:"9",color:"text",handler:()=>e("add","9")},{text:"*",color:"accent",handler:()=>e("add","*")},{text:"4",color:"text",handler:()=>e("add","4")},{text:"5",color:"text",handler:()=>e("add","5")},{text:"6",color:"text",handler:()=>e("add","6")},{text:"-",color:"accent",handler:()=>e("add","-")},{text:"1",color:"text",handler:()=>e("add","1")},{text:"2",color:"text",handler:()=>e("add","2")},{text:"3",color:"text",handler:()=>e("add","3")},{text:"+",color:"accent",handler:()=>e("add","+")},{text:"0",color:"text",handler:()=>e("add","0")},{text:"000",color:"text",handler:()=>e("add","000")},{text:".",color:"text",handler:()=>e("add",".")},{text:"=",color:"bg",round:!0,handler:()=>e("submit")}]]}lt.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",lt.bracketsRegexpString="[()]";class pt extends F{constructor(t){super(),I(this,t,ft,dt,c,{})}}function gt(t,e,n){const r=t.slice();return r[4]=e[n],r}function mt(e){let n,r,o,c,i=e[4].label+"";return{c(){n=d("option"),r=f(i),o=p(),n.__value=c=e[4].id,n.value=n.__value,m(n,"class","theme-changer__option")},m(t,e){l(t,n,e),a(n,r),a(n,o)},p:t,d(t){t&&u(n)}}}function $t(e){let n,r,o,c,i,f,$,w,x=e[2],b=[];for(let t=0;t<x.length;t+=1)b[t]=mt(gt(e,x,t));return{c(){n=d("div"),r=d("i"),i=p(),f=d("select");for(let t=0;t<b.length;t+=1)b[t].c();m(r,"class",o=s(`fas theme-changer__icon fa-${e[1].icon}`)+" svelte-lru31z"),m(r,"title",c=e[1].label),m(f,"aria-label","Color theme select"),m(f,"class","theme-changer__select svelte-lru31z"),void 0===e[0]&&D((()=>e[3].call(f))),m(n,"class","theme-changer svelte-lru31z")},m(t,o){l(t,n,o),a(n,r),a(n,i),a(n,f);for(let t=0;t<b.length;t+=1)b[t].m(f,null);v(f,e[0]),$||(w=g(f,"change",e[3]),$=!0)},p(t,[e]){if(2&e&&o!==(o=s(`fas theme-changer__icon fa-${t[1].icon}`)+" svelte-lru31z")&&m(r,"class",o),2&e&&c!==(c=t[1].label)&&m(r,"title",c),4&e){let n;for(x=t[2],n=0;n<x.length;n+=1){const r=gt(t,x,n);b[n]?b[n].p(r,e):(b[n]=mt(r),b[n].c(),b[n].m(f,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=x.length}5&e&&v(f,t[0])},i:t,o:t,d(t){t&&u(n),h(b,t),$=!1,w()}}}function vt(t,e,n){let r,o;i(t,Q,(t=>n(0,o=t)));const c=[{id:W.Light,label:"Light",icon:"sun"},{id:W.Dark,label:"Dark",icon:"moon"},{id:W.Default,label:"System",icon:"adjust"}];return t.$$.update=()=>{1&t.$$.dirty&&n(1,r=c.find((({id:t})=>t===o)))},[o,r,c,function(){o=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),Q.set(o),n(2,c)}]}class wt extends F{constructor(t){super(),I(this,t,vt,$t,c,{})}}function xt(t){let e,n,r,o,c,i,s,h,g,v,w,x,b;return r=new wt({}),x=new pt({}),x.$on("add",t[2]),x.$on("reset",t[3]),x.$on("submit",t[4]),{c(){e=d("main"),n=d("div"),q(r.$$.fragment),o=p(),c=d("div"),i=f(t[0]),s=p(),h=d("div"),g=f(t[1]),v=p(),w=d("div"),q(x.$$.fragment),m(n,"class","calculator__settings"),m(c,"class","calculator__result svelte-1jh8uf2"),m(h,"class","calculator__query svelte-1jh8uf2"),m(w,"class","calculator__keyboard svelte-1jh8uf2"),m(e,"class","calculator svelte-1jh8uf2")},m(t,u){l(t,e,u),a(e,n),T(r,n,null),a(e,o),a(e,c),a(c,i),a(e,s),a(e,h),a(h,g),a(e,v),a(e,w),T(x,w,null),b=!0},p(t,[e]){(!b||1&e)&&$(i,t[0]),(!b||2&e)&&$(g,t[1])},i(t){b||(O(r.$$.fragment,t),O(x.$$.fragment,t),b=!0)},o(t){z(r.$$.fragment,t),z(x.$$.fragment,t),b=!1},d(t){t&&u(e),B(r),B(x)}}}const bt=new lt;function yt(t,e,n){let r=0,o=null,c="";return[r,c,({detail:t})=>{n(1,c+=t)},()=>{n(1,c=""),n(0,r=0),o=null},()=>{try{o=bt.compile(c),n(0,r=o.exec()),n(1,c=o.view(-1))}catch(t){console.error(t)}}]}class kt extends F{constructor(t){super(),I(this,t,yt,xt,c,{})}}function _t(t){let e,n,r;return n=new kt({}),{c(){e=d("div"),q(n.$$.fragment),m(e,"class","container svelte-8c6ys1"),w(e,"dark","dark"===t[0]),w(e,"light","light"===t[0])},m(t,o){l(t,e,o),T(n,e,null),r=!0},p(t,[n]){1&n&&w(e,"dark","dark"===t[0]),1&n&&w(e,"light","light"===t[0])},i(t){r||(O(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){t&&u(e),B(n)}}}function Et(t,e,n){let r;return i(t,Q,(t=>n(0,r=t))),[r]}const At=new class extends F{constructor(t){super(),I(this,t,Et,_t,c,{})}}({target:document.body});return window.Calculator=lt,window.calc=new lt,At}();
//# sourceMappingURL=bundle.js.map
