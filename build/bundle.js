var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function c(t){t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function p(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}let h;function l(t){h=t}const f=[],g=[],m=[],w=[],d=Promise.resolve();let $=!1;function v(t){m.push(t)}let y=!1;const b=new Set;function k(){if(!y){y=!0;do{for(let t=0;t<f.length;t+=1){const e=f[t];l(e),x(e.$$)}for(l(null),f.length=0;g.length;)g.pop()();for(let t=0;t<m.length;t+=1){const e=m[t];b.has(e)||(b.add(e),e())}m.length=0}while(f.length);for(;w.length;)w.pop()();$=!1,y=!1,b.clear()}}function x(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(v)}}const E=new Set;function _(t,e){-1===t.$$.dirty[0]&&(f.push(t),$||($=!0,d.then(k)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function A(i,s,a,u,p,f,g,m=[-1]){const w=h;l(i);const d=i.$$={fragment:null,ctx:null,props:f,update:t,not_equal:p,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(w?w.$$.context:[])),callbacks:r(),dirty:m,skip_bound:!1,root:s.target||w.$$.root};g&&g(d.root);let $=!1;if(d.ctx=a?a(i,s.props||{},((t,e,...r)=>{const n=r.length?r[0]:e;return d.ctx&&p(d.ctx[t],d.ctx[t]=n)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](n),$&&_(i,t)),e})):[],d.update(),$=!0,n(d.before_update),d.fragment=!!u&&u(d.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);d.fragment&&d.fragment.l(t),t.forEach(c)}else d.fragment&&d.fragment.c();s.intro&&((y=i.$$.fragment)&&y.i&&(E.delete(y),y.i(b))),function(t,r,i,s){const{fragment:c,on_mount:a,on_destroy:u,after_update:p}=t.$$;c&&c.m(r,i),s||v((()=>{const r=a.map(e).filter(o);u?u.push(...r):n(r),t.$$.on_mount=[]})),p.forEach(v)}(i,s.target,s.anchor,s.customElement),k()}var y,b;l(w)}function S(e){let r,n,o,i,h,l,f;return{c(){r=a("main"),n=a("h1"),o=u("Hello "),i=u(e[0]),h=u("!"),l=u(" "),f=a("p"),f.innerHTML='Visit the <a href="https://svelte.dev/tutorial">Svelte tutorial</a> to learn\n    how to build Svelte apps.',p(n,"class","svelte-1hoym3u"),p(r,"class","svelte-1hoym3u")},m(t,e){!function(t,e,r){t.insertBefore(e,r||null)}(t,r,e),s(r,n),s(n,o),s(n,i),s(n,h),s(r,l),s(r,f)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,t[0])},i:t,o:t,d(t){t&&c(r)}}}function M(t,e,r){let{name:n}=e;return t.$$set=t=>{"name"in t&&r(0,n=t.name)},[n]}class V{constructor({token:t,priority:e=0,oneArgument:r=!1,view:n,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=r,this.calc=o,n)this.view=n;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const n=e?t[0]:t;this.view=r?t=>`${t}${n}`:(t,e)=>`${t} ${n} ${e}`}}}var R=new V({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),O=new V({token:"+",calc:(t,e)=>t+e}),T=new V({token:"-",calc:(t,e)=>t-e}),j=new V({token:"*",priority:5,calc:(t,e)=>t*e}),B=new V({token:"/",priority:5,calc:(t,e)=>t/e}),N=new V({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),q=new V({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const D=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*D(t-1)};var C=new V({token:"!",priority:10,oneArgument:!0,calc:D,view:t=>`${t}!`});const F=[O,T,j,B,N,q,C];class H{constructor(t,e,r){if(this.operator=t,this.v1=e,this.v2=r,!t.oneArgument&&void 0===r)throw new Error(`Operator "${t.token}" require two arguments`)}getMaxDepth(){const t=this.v1 instanceof H?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof H?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof H){const e=this.v1.operator.priority<this.operator.priority,r=this.v1.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof H){const e=this.v2.operator.priority<this.operator.priority,r=this.v2.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const r=this.getV2View(t);return this.operator.view(e,r)}exec(){if(this.result)return this.result;const t=this.v1 instanceof H?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof H?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const I=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class L{constructor({operators:t=F}={}){this.operators=t}getMatchRegex(){const t=[{matcher:this.operators.reduce(((t,{token:e})=>t.concat(e)),[]).map(I).join("|"),name:"operator"},{matcher:L.numberRegexpString,name:"number"},{matcher:L.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(t,"g")}static validateBrackets(t){const e=t.match(new RegExp(L.bracketsRegexpString,"g"));if(!e)return!0;let r=0;return e.forEach((t=>{")"===t?r--:r++})),0===r}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=((t,e)=>{const r=[];let n;for(;n=t.exec(e);)r.push(n);return r})(this.getMatchRegex(),t),r=[];let n=0;return e.forEach((({groups:t},o)=>{const{number:i,bracket:s,operator:c}=t,a=e[o-1],u=e[o+1];if(s)")"===s?n-=100:"("===s&&(a&&a.groups.number&&r.push({operator:j,priority:n+j.priority}),n+=100);else if(c)if("+"!==c&&"-"!==c||a&&!(a&&a.groups.operator&&u&&u.groups.number)){const t=this.getOperatorByToken(c);r.push({operator:t,priority:n+t.priority})}else u.groups.number=`${c}${u.groups.number}`;else if(i){const{groups:{bracket:t=null}={}}=a||{};")"===t&&r.push({operator:j,priority:n+j.priority}),r.push(parseFloat(i.replace(",",".")))}})),r}compile(t=""){if(!L.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),r=e.filter((t=>"number"!=typeof t)),n=e.slice();if(r.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:r}=t,o=n.indexOf(t),i=n[o-1];if(i&&"number"!=typeof i&&!(i instanceof H)){const{operator:{token:t}}=i;throw new Error(`Two operators in a row 1:"${t}", 2:"${e.token}"`)}if(e.oneArgument)n.splice(o-1,2,new H(e,i));else{const t=n[o+1];if(t&&"number"!=typeof t&&!(t instanceof H)){const{operator:{token:r}}=t;throw new Error(`Two operators in a row 1:"${e.token}", 2:"${r}"`)}n.splice(o-1,3,new H(e,i,t))}})),n.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!n.length)throw new Error("No operators");const o=n[0];return"number"==typeof o?new H(R,o):o}calc(t=""){return this.compile(t).exec()}}L.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",L.bracketsRegexpString="[()]",window.Calculator=L,window.calc=new L;return new class extends class{$destroy(){!function(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),A(this,t,M,S,i,{name:0})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
