var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function c(t,e,r){t.insertBefore(e,r||null)}function a(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function h(){return l(" ")}function p(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function f(t,e,r){t.classList[r?"add":"remove"](e)}let d;function g(t){d=t}const m=[],$=[],w=[],v=[],y=Promise.resolve();let k=!1;function b(t){w.push(t)}let x=!1;const _=new Set;function E(){if(!x){x=!0;do{for(let t=0;t<m.length;t+=1){const e=m[t];g(e),A(e.$$)}for(g(null),m.length=0;$.length;)$.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];_.has(e)||(_.add(e),e())}w.length=0}while(m.length);for(;v.length;)v.pop()();k=!1,x=!1,_.clear()}}function A(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(b)}}const T=new Set;function S(t,e){t&&t.i&&(T.delete(t),t.i(e))}function M(t,e,r,n){if(t&&t.o){if(T.has(t))return;T.add(t),undefined.c.push((()=>{T.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}function V(t){t&&t.c()}function R(t,r,i,s){const{fragment:c,on_mount:a,on_destroy:u,after_update:l}=t.$$;c&&c.m(r,i),s||b((()=>{const r=a.map(e).filter(o);u?u.push(...r):n(r),t.$$.on_mount=[]})),l.forEach(b)}function D(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function O(t,e){-1===t.$$.dirty[0]&&(m.push(t),k||(k=!0,y.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function j(e,o,i,s,c,u,l,h=[-1]){const p=d;g(e);const f=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:c,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(p?p.$$.context:[])),callbacks:r(),dirty:h,skip_bound:!1,root:o.target||p.$$.root};l&&l(f.root);let m=!1;if(f.ctx=i?i(e,o.props||{},((t,r,...n)=>{const o=n.length?n[0]:r;return f.ctx&&c(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),m&&O(e,t)),r})):[],f.update(),m=!0,n(f.before_update),f.fragment=!!s&&s(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(a)}else f.fragment&&f.fragment.c();o.intro&&S(e.$$.fragment),R(e,o.target,o.anchor,o.customElement),E()}g(p)}class B{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function N(e){let r,n,o;return{c(){r=u("div"),n=l("Keyboard "),o=l(e[0]),p(r,"class","keyboard"),f(r,"keyboard_advance",e[0])},m(t,e){c(t,r,e),s(r,n),s(r,o)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(o,t[0]),1&e&&f(r,"keyboard_advance",t[0])},i:t,o:t,d(t){t&&a(r)}}}function q(t,e,r){let{advanced:n=!1}=e;return t.$$set=t=>{"advanced"in t&&r(0,n=t.advanced)},[n]}class C extends B{constructor(t){super(),j(this,t,q,N,i,{advanced:0})}}function L(e){let r,n,o,i,l,f,d,g,m;return g=new C({}),{c(){r=u("main"),n=u("h1"),n.textContent="Hello world!",o=h(),i=u("i"),l=h(),f=u("p"),f.innerHTML='Visit the <a href="https://svelte.dev/tutorial">Svelte tutorial</a> to learn\n    how to build Svelte apps.',d=h(),V(g.$$.fragment),p(i,"class","fas fa-user"),p(r,"class","calculator svelte-1thpeah")},m(t,e){c(t,r,e),s(r,n),s(r,o),s(r,i),s(r,l),s(r,f),s(r,d),R(g,r,null),m=!0},p:t,i(t){m||(S(g.$$.fragment,t),m=!0)},o(t){M(g.$$.fragment,t),m=!1},d(t){t&&a(r),D(g)}}}function F(t,e,r){let{colorTheme:n}=e;return t.$$set=t=>{"colorTheme"in t&&r(0,n=t.colorTheme)},[n]}class H extends B{constructor(t){super(),j(this,t,F,L,i,{colorTheme:0})}}var I;!function(t){t.Dark="dark",t.Light="light",t.Default="default"}(I||(I={}));const K=(P=I,t=>Object.values(P).includes(t));var P;function W(t){let e,r,n,o;function i(e){t[1](e)}let s={};return void 0!==t[0]&&(s.colorTheme=t[0]),r=new H({props:s}),$.push((()=>function(t,e,r){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}(r,"colorTheme",i))),{c(){e=u("div"),V(r.$$.fragment),p(e,"class","container svelte-t8ly9w"),f(e,"dark","dark"===t[0]),f(e,"light","light"===t[0])},m(t,n){c(t,e,n),R(r,e,null),o=!0},p(t,[o]){const i={};var s;!n&&1&o&&(n=!0,i.colorTheme=t[0],s=()=>n=!1,v.push(s)),r.$set(i),1&o&&f(e,"dark","dark"===t[0]),1&o&&f(e,"light","light"===t[0])},i(t){o||(S(r.$$.fragment,t),o=!0)},o(t){M(r.$$.fragment,t),o=!1},d(t){t&&a(e),D(r)}}}function z(t,e,r){let n=(()=>{try{const t=window.localStorage.getItem("color-theme");return K(t)?t:I.Default}catch(t){return I.Default}})();return[n,function(t){n=t,r(0,n)}]}class G{constructor({token:t,priority:e=0,oneArgument:r=!1,view:n,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=r,this.calc=o,n)this.view=n;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const n=e?t[0]:t;this.view=r?t=>`${t}${n}`:(t,e)=>`${t} ${n} ${e}`}}}var J=new G({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),Q=new G({token:"+",calc:(t,e)=>t+e}),U=new G({token:"-",calc:(t,e)=>t-e}),X=new G({token:"*",priority:5,calc:(t,e)=>t*e}),Y=new G({token:"/",priority:5,calc:(t,e)=>t/e}),Z=new G({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),tt=new G({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const et=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*et(t-1)};var rt=new G({token:"!",priority:10,oneArgument:!0,calc:et,view:t=>`${t}!`});const nt=[Q,U,X,Y,Z,tt,rt];class ot{constructor(t,e,r){if(this.operator=t,this.v1=e,this.v2=r,!t.oneArgument&&void 0===r)throw new Error(`Operator "${t.token}" require two arguments`)}getMaxDepth(){const t=this.v1 instanceof ot?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof ot?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof ot){const e=this.v1.operator.priority<this.operator.priority,r=this.v1.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof ot){const e=this.v2.operator.priority<this.operator.priority,r=this.v2.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const r=this.getV2View(t);return this.operator.view(e,r)}exec(){if(this.result)return this.result;const t=this.v1 instanceof ot?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof ot?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const it=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class st{constructor({operators:t=nt}={}){this.operators=t}getMatchRegex(){const t=[{matcher:this.operators.reduce(((t,{token:e})=>t.concat(e)),[]).map(it).join("|"),name:"operator"},{matcher:st.numberRegexpString,name:"number"},{matcher:st.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(t,"g")}static validateBrackets(t){const e=t.match(new RegExp(st.bracketsRegexpString,"g"));if(!e)return!0;let r=0;return e.forEach((t=>{")"===t?r--:r++})),0===r}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=((t,e)=>{const r=[];let n;for(;n=t.exec(e);)r.push(n);return r})(this.getMatchRegex(),t),r=[];let n=0;return e.forEach((({groups:t},o)=>{const{number:i,bracket:s,operator:c}=t,a=e[o-1],u=e[o+1];if(s)")"===s?n-=100:"("===s&&(a&&a.groups.number&&r.push({operator:X,priority:n+X.priority}),n+=100);else if(c)if("+"!==c&&"-"!==c||a&&!(a&&a.groups.operator&&u&&u.groups.number)){const t=this.getOperatorByToken(c);r.push({operator:t,priority:n+t.priority})}else u.groups.number=`${c}${u.groups.number}`;else if(i){const{groups:{bracket:t=null}={}}=a||{};")"===t&&r.push({operator:X,priority:n+X.priority}),r.push(parseFloat(i.replace(",",".")))}})),r}compile(t=""){if(!st.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),r=e.filter((t=>"number"!=typeof t)),n=e.slice();if(r.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:r}=t,o=n.indexOf(t),i=n[o-1];if(i&&"number"!=typeof i&&!(i instanceof ot)){const{operator:{token:t}}=i;throw new Error(`Two operators in a row 1:"${t}", 2:"${e.token}"`)}if(e.oneArgument)n.splice(o-1,2,new ot(e,i));else{const t=n[o+1];if(t&&"number"!=typeof t&&!(t instanceof ot)){const{operator:{token:r}}=t;throw new Error(`Two operators in a row 1:"${e.token}", 2:"${r}"`)}n.splice(o-1,3,new ot(e,i,t))}})),n.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!n.length)throw new Error("No operators");const o=n[0];return"number"==typeof o?new ot(J,o):o}calc(t=""){return this.compile(t).exec()}}st.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",st.bracketsRegexpString="[()]";const ct=new class extends B{constructor(t){super(),j(this,t,z,W,i,{})}}({target:document.body});return window.Calculator=st,window.calc=new st,ct}();
//# sourceMappingURL=bundle.js.map
