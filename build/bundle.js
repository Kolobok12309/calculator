var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function s(t){return null==t?"":t}function i(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}t.selectedIndex=-1}function v(t,e,n){t.classList[n?"add":"remove"](e)}class x{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=h(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)l(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(u)}}let w;function b(t){w=t}function y(){const t=function(){if(!w)throw new Error("Function called outside component initialization");return w}();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}const k=[],_=[],E=[],A=[],M=Promise.resolve();let q=!1;function S(t){E.push(t)}let D=!1;const L=new Set;function R(){if(!D){D=!0;do{for(let t=0;t<k.length;t+=1){const e=k[t];b(e),V(e.$$)}for(b(null),k.length=0;_.length;)_.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];L.has(e)||(L.add(e),e())}E.length=0}while(k.length);for(;A.length;)A.pop()();q=!1,D=!1,L.clear()}}function V(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const j=new Set;function T(t,e){t&&t.i&&(j.delete(t),t.i(e))}function C(t,e,n,r){if(t&&t.o){if(j.has(t))return;j.add(t),undefined.c.push((()=>{j.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function O(t){t&&t.c()}function z(t,n,c,a){const{fragment:s,on_mount:i,on_destroy:l,after_update:u}=t.$$;s&&s.m(n,c),a||S((()=>{const n=i.map(e).filter(o);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(S)}function N(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function F(t,e){-1===t.$$.dirty[0]&&(k.push(t),q||(q=!0,M.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(e,o,c,a,s,i,l,d=[-1]){const h=w;b(e);const f=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||h.$$.root};l&&l(f.root);let p=!1;if(f.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&F(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!a&&a(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();o.intro&&T(e.$$.fragment),z(e,o.target,o.anchor,o.customElement),R()}b(h)}class I{$destroy(){N(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const H=[];var P;!function(t){t.Dark="dark",t.Light="light",t.Default="default"}(P||(P={}));const W="color-theme",G=window.localStorage,J=(K=P,t=>Object.values(K).includes(t));var K;const Q=(()=>{let e=P.Default;try{const t=G.getItem(W);J(t)&&(e=t)}catch(t){}const{subscribe:n,set:r}=function(e,n=t){let r;const o=new Set;function a(t){if(c(e,t)&&(e=t,r)){const t=!H.length;for(const t of o)t[1](),H.push(t,e);if(t){for(let t=0;t<H.length;t+=2)H[t][0](H[t+1]);H.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(c,s=t){const i=[c,s];return o.add(i),1===o.size&&(r=n(a)||t),c(e),()=>{o.delete(i),0===o.size&&(r(),r=null)}}}}(e,(t=>{const e=({storageArea:e,key:n,newValue:r})=>{e===G&&n===W&&J(r)&&t(r)};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}));return{subscribe:n,set:t=>{let e=P.Default;J(t)&&(e=t);try{G.setItem(W,e),r(e)}catch(t){}}}})();class U{constructor({token:t,priority:e=0,oneArgument:n=!1,view:r,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=n,this.calc=o,r)this.view=r;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const r=e?t[0]:t;this.view=n?t=>`${t}${r}`:(t,e)=>`${t} ${r} ${e}`}}}var X=new U({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),Y=new U({token:"+",calc:(t,e)=>t+e}),Z=new U({token:"-",calc:(t,e)=>t-e}),tt=new U({token:"*",priority:5,calc:(t,e)=>t*e}),et=new U({token:"/",priority:5,calc:(t,e)=>t/e}),nt=new U({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),rt=new U({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const ot=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*ot(t-1)};var ct=new U({token:"!",priority:10,oneArgument:!0,calc:ot,view:t=>`${t}!`});const at=[Y,Z,tt,et,nt,rt,ct];class st{constructor(t,e,n){if(this.operator=t,this.v1=e,this.v2=n,!t.oneArgument&&void 0===n)throw new Error(`Operator "${t.token}" require two arguments`)}getMaxDepth(){const t=this.v1 instanceof st?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof st?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof st){const e=this.v1.operator.priority<this.operator.priority,n=this.v1.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof st){const e=this.v2.operator!==this.operator&&this.v2.operator.priority<=this.operator.priority,n=this.v2.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const n=this.getV2View(t);return this.operator.view(e,n)}exec(){if(this.result)return this.result;const t=this.v1 instanceof st?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof st?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const it=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class lt{constructor({operators:t=at}={}){this.operators=t}getMatchRegex(){const t=[{matcher:this.operators.reduce(((t,{token:e})=>t.concat(e)),[]).map(it).join("|"),name:"operator"},{matcher:lt.numberRegexpString,name:"number"},{matcher:lt.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(t,"g")}static validateBrackets(t){const e=t.match(new RegExp(lt.bracketsRegexpString,"g"));if(!e)return!0;let n=0;return e.forEach((t=>{")"===t?n--:n++})),0===n}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=((t,e)=>{const n=[];let r;for(;r=t.exec(e);)n.push(r);return n})(this.getMatchRegex(),t),n=[];let r=0;return e.forEach((({groups:t},o)=>{const{number:c,bracket:a,operator:s}=t,i=e[o-1],l=e[o+1];if(a)")"===a?r-=100:"("===a&&(i&&i.groups.number&&n.push({operator:tt,priority:r+tt.priority}),r+=100);else if(s)if("+"!==s&&"-"!==s||i&&!(i&&i.groups.operator&&l&&l.groups.number)){const t=this.getOperatorByToken(s);n.push({operator:t,priority:r+t.priority})}else l.groups.number=`${s}${l.groups.number}`;else if(c){const{groups:{bracket:t=null}={}}=i||{};")"===t&&n.push({operator:tt,priority:r+tt.priority}),n.push(parseFloat(c.replace(",",".")))}})),n}compile(t=""){if(!lt.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),n=e.filter((t=>"number"!=typeof t)),r=e.slice();if(n.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:n}=t,o=r.indexOf(t),c=r[o-1];if(c&&"number"!=typeof c&&!(c instanceof st)){const{operator:{token:t}}=c;throw new Error(`Two operators in a row 1:"${t}", 2:"${e.token}"`)}if(e.oneArgument)r.splice(o-1,2,new st(e,c));else{const t=r[o+1];if(t&&"number"!=typeof t&&!(t instanceof st)){const{operator:{token:n}}=t;throw new Error(`Two operators in a row 1:"${e.token}", 2:"${n}"`)}r.splice(o-1,3,new st(e,c,t))}})),r.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!r.length)throw new Error("No operators");const o=r[0];return"number"==typeof o?new st(X,o):o}calc(t=""){return this.compile(t).exec()}}function ut(t,e,n){const r=t.slice();return r[2]=e[n],r}function dt(t){let e,n,r,o,c,a,d=t[2].text+"";return{c(){e=h("button"),n=new x,r=p(),n.a=r,m(e,"class",o=s(`keyboard__btn keyboard__btn_${t[2].color}`)+" svelte-j54va6"),v(e,"keyboard__btn_round",t[2].round),v(e,"keyboard__btn_advanced",t[2].advanced)},m(o,s){l(o,e,s),n.m(d,e),i(e,r),c||(a=g(e,"click",t[2].handler),c=!0)},p(e,n){t=e},d(t){t&&u(e),c=!1,a()}}}function ht(e){let n,r=e[0],o=[];for(let t=0;t<r.length;t+=1)o[t]=dt(ut(e,r,t));return{c(){n=h("div");for(let t=0;t<o.length;t+=1)o[t].c();m(n,"class","keyboard svelte-j54va6")},m(t,e){l(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){if(1&e){let c;for(r=t[0],c=0;c<r.length;c+=1){const a=ut(t,r,c);o[c]?o[c].p(a,e):(o[c]=dt(a),o[c].c(),o[c].m(n,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:t,o:t,d(t){t&&u(n),d(o,t)}}}function ft(t){const e=y();return[[{text:"(",color:"accent",advanced:!0,handler:()=>e("add","(")},{text:")",color:"accent",advanced:!0,handler:()=>e("add",")")},{text:"x!",color:"accent",advanced:!0,handler:()=>e("add","!")},{text:"_",color:"accent",advanced:!0,handler:()=>e("add"," ")},{text:"C",color:"red",handler:()=>e("reset")},{text:"CA",color:"red",handler:()=>e("reset")},{text:"←",color:"red",handler:()=>e("backspace")},{text:"/",color:"accent",handler:()=>e("add"," / ")},{text:"x<sup>2</sup>",color:"accent",advanced:!0,handler:()=>e("add","^2 ")},{text:"x<sup>3</sup>",color:"accent",advanced:!0,handler:()=>e("add","^3 ")},{text:"x<sup>y</sup>",color:"accent",advanced:!0,handler:()=>e("add","^")},{text:"10<sup>x</sup>",color:"accent",advanced:!0,handler:()=>e("add","10^")},{text:"7",color:"text",handler:()=>e("add","7")},{text:"8",color:"text",handler:()=>e("add","8")},{text:"9",color:"text",handler:()=>e("add","9")},{text:"∗",color:"accent",handler:()=>e("add"," * ")},{text:"√2",color:"accent",advanced:!0,handler:()=>e("add","^(1/2) ")},{text:"√3",color:"accent",advanced:!0,handler:()=>e("add","^(1/3) ")},{text:"e",color:"accent",advanced:!0,handler:()=>e("add",`${Math.E.toFixed(3)}`)},{text:"π",color:"accent",advanced:!0,handler:()=>e("add",`${Math.PI.toFixed(3)}`)},{text:"4",color:"text",handler:()=>e("add","4")},{text:"5",color:"text",handler:()=>e("add","5")},{text:"6",color:"text",handler:()=>e("add","6")},{text:"-",color:"accent",handler:()=>e("add","-")},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"1",color:"text",handler:()=>e("add","1")},{text:"2",color:"text",handler:()=>e("add","2")},{text:"3",color:"text",handler:()=>e("add","3")},{text:"+",color:"accent",handler:()=>e("add","+")},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"",color:"accent",advanced:!0,handler:()=>{}},{text:"Rand",color:"accent",advanced:!0,handler:()=>e("add",`${Math.random().toFixed(3)}`)},{text:"0",color:"text",handler:()=>e("add","0")},{text:"000",color:"text",handler:()=>e("add","000")},{text:".",color:"text",handler:()=>e("add",".")},{text:"=",color:"bg",round:!0,handler:()=>e("submit")}]]}lt.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",lt.bracketsRegexpString="[()]";class pt extends I{constructor(t){super(),B(this,t,ft,ht,c,{})}}function gt(t,e,n){const r=t.slice();return r[4]=e[n],r}function mt(e){let n,r,o,c,a=e[4].label+"";return{c(){n=h("option"),r=f(a),o=p(),n.__value=c=e[4].id,n.value=n.__value,m(n,"class","theme-changer__option")},m(t,e){l(t,n,e),i(n,r),i(n,o)},p:t,d(t){t&&u(n)}}}function $t(e){let n,r,o,c,a,f,v,x,w=e[2],b=[];for(let t=0;t<w.length;t+=1)b[t]=mt(gt(e,w,t));return{c(){n=h("div"),r=h("i"),a=p(),f=h("select");for(let t=0;t<b.length;t+=1)b[t].c();m(r,"class",o=s(`fas theme-changer__icon fa-${e[1].icon}`)+" svelte-zgfek1"),m(r,"title",c=e[1].label),m(f,"aria-label","Color theme select"),m(f,"class","theme-changer__select svelte-zgfek1"),void 0===e[0]&&S((()=>e[3].call(f))),m(n,"class","theme-changer svelte-zgfek1")},m(t,o){l(t,n,o),i(n,r),i(n,a),i(n,f);for(let t=0;t<b.length;t+=1)b[t].m(f,null);$(f,e[0]),v||(x=g(f,"change",e[3]),v=!0)},p(t,[e]){if(2&e&&o!==(o=s(`fas theme-changer__icon fa-${t[1].icon}`)+" svelte-zgfek1")&&m(r,"class",o),2&e&&c!==(c=t[1].label)&&m(r,"title",c),4&e){let n;for(w=t[2],n=0;n<w.length;n+=1){const r=gt(t,w,n);b[n]?b[n].p(r,e):(b[n]=mt(r),b[n].c(),b[n].m(f,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=w.length}5&e&&$(f,t[0])},i:t,o:t,d(t){t&&u(n),d(b,t),v=!1,x()}}}function vt(t,e,n){let r,o;a(t,Q,(t=>n(0,o=t)));const c=[{id:P.Light,label:"Light",icon:"sun"},{id:P.Dark,label:"Dark",icon:"moon"},{id:P.Default,label:"System",icon:"adjust"}];return t.$$.update=()=>{1&t.$$.dirty&&n(1,r=c.find((({id:t})=>t===o)))},[o,r,c,function(){o=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),Q.set(o),n(2,c)}]}class xt extends I{constructor(t){super(),B(this,t,vt,$t,c,{})}}function wt(e){let n,r;return{c(){n=h("div"),r=f(e[0]),m(n,"class","display svelte-1kxk3qs")},m(t,e){l(t,n,e),i(n,r)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(r,t[0])},i:t,o:t,d(t){t&&u(n)}}}function bt(t,e,n){let{result:r=0}=e;return t.$$set=t=>{"result"in t&&n(0,r=t.result)},[r]}class yt extends I{constructor(t){super(),B(this,t,bt,wt,c,{result:0})}}function kt(e){let n;return{c(){n=h("div"),m(n,"class","display svelte-tb2wqk")},m(t,r){l(t,n,r),n.innerHTML=e[0]},p(t,[e]){1&e&&(n.innerHTML=t[0])},i:t,o:t,d(t){t&&u(n)}}}function _t(t,e,n){let r,{query:o=""}=e;const c=(t,e="")=>`<span class="display__${t}">${e}</span>`;return t.$$set=t=>{"query"in t&&n(1,o=t.query)},t.$$.update=()=>{2&t.$$.dirty&&n(0,r=o.replace(/ +/g,c("space")).replace(/\d+/g,(t=>c("num",t))))},[r,o]}class Et extends I{constructor(t){super(),B(this,t,_t,kt,c,{query:1})}}function At(t){let e,n,r,o,c,a,s,d,f,g,$,v,x;return r=new xt({}),a=new yt({props:{result:t[0]}}),f=new Et({props:{query:t[1]}}),v=new pt({}),v.$on("add",t[2]),v.$on("backspace",t[3]),v.$on("reset",t[4]),v.$on("submit",t[5]),{c(){e=h("main"),n=h("div"),O(r.$$.fragment),o=p(),c=h("div"),O(a.$$.fragment),s=p(),d=h("div"),O(f.$$.fragment),g=p(),$=h("div"),O(v.$$.fragment),m(n,"class","calculator__settings svelte-1a6ev4m"),m(c,"class","calculator__result"),m(d,"class","calculator__query"),m($,"class","calculator__keyboard svelte-1a6ev4m"),m(e,"class","calculator svelte-1a6ev4m")},m(t,u){l(t,e,u),i(e,n),z(r,n,null),i(e,o),i(e,c),z(a,c,null),i(e,s),i(e,d),z(f,d,null),i(e,g),i(e,$),z(v,$,null),x=!0},p(t,[e]){const n={};1&e&&(n.result=t[0]),a.$set(n);const r={};2&e&&(r.query=t[1]),f.$set(r)},i(t){x||(T(r.$$.fragment,t),T(a.$$.fragment,t),T(f.$$.fragment,t),T(v.$$.fragment,t),x=!0)},o(t){C(r.$$.fragment,t),C(a.$$.fragment,t),C(f.$$.fragment,t),C(v.$$.fragment,t),x=!1},d(t){t&&u(e),N(r),N(a),N(f),N(v)}}}const Mt=new lt;function qt(t,e,n){let r=0,o=null,c="";return[r,c,({detail:t})=>{n(1,c+=t)},()=>{n(1,c=c.slice(0,-1))},()=>{n(1,c=""),n(0,r=0),o=null},()=>{try{o=Mt.compile(c),n(0,r=o.exec()),n(1,c=o.view(-1))}catch(t){console.error(t)}}]}class St extends I{constructor(t){super(),B(this,t,qt,At,c,{})}}function Dt(t){let e,n,r;return n=new St({}),{c(){e=h("div"),O(n.$$.fragment),m(e,"class","container svelte-sxoyrg"),v(e,"dark","dark"===t[0]),v(e,"light","light"===t[0])},m(t,o){l(t,e,o),z(n,e,null),r=!0},p(t,[n]){1&n&&v(e,"dark","dark"===t[0]),1&n&&v(e,"light","light"===t[0])},i(t){r||(T(n.$$.fragment,t),r=!0)},o(t){C(n.$$.fragment,t),r=!1},d(t){t&&u(e),N(n)}}}function Lt(t,e,n){let r;return a(t,Q,(t=>n(0,r=t))),[r]}const Rt=new class extends I{constructor(t){super(),B(this,t,Lt,Dt,c,{})}}({target:document.body});return window.Calculator=lt,window.calc=new lt,Rt}();
//# sourceMappingURL=bundle.js.map
