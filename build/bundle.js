var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function c(t){t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function l(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}let h;function p(t){h=t}const f=[],g=[],m=[],d=[],w=Promise.resolve();let $=!1;function v(t){m.push(t)}let y=!1;const x=new Set;function k(){if(!y){y=!0;do{for(let t=0;t<f.length;t+=1){const e=f[t];p(e),b(e.$$)}for(p(null),f.length=0;g.length;)g.pop()();for(let t=0;t<m.length;t+=1){const e=m[t];x.has(e)||(x.add(e),e())}m.length=0}while(f.length);for(;d.length;)d.pop()();$=!1,y=!1,x.clear()}}function b(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(v)}}const A=new Set;function _(t,e){-1===t.$$.dirty[0]&&(f.push(t),$||($=!0,w.then(k)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function E(i,s,a,u,l,f,g,m=[-1]){const d=h;p(i);const w=i.$$={fragment:null,ctx:null,props:f,update:t,not_equal:l,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(d?d.$$.context:[])),callbacks:r(),dirty:m,skip_bound:!1,root:s.target||d.$$.root};g&&g(w.root);let $=!1;if(w.ctx=a?a(i,s.props||{},((t,e,...r)=>{const n=r.length?r[0]:e;return w.ctx&&l(w.ctx[t],w.ctx[t]=n)&&(!w.skip_bound&&w.bound[t]&&w.bound[t](n),$&&_(i,t)),e})):[],w.update(),$=!0,n(w.before_update),w.fragment=!!u&&u(w.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);w.fragment&&w.fragment.l(t),t.forEach(c)}else w.fragment&&w.fragment.c();s.intro&&((y=i.$$.fragment)&&y.i&&(A.delete(y),y.i(x))),function(t,r,i,s){const{fragment:c,on_mount:a,on_destroy:u,after_update:l}=t.$$;c&&c.m(r,i),s||v((()=>{const r=a.map(e).filter(o);u?u.push(...r):n(r),t.$$.on_mount=[]})),l.forEach(v)}(i,s.target,s.anchor,s.customElement),k()}var y,x;p(d)}function S(e){let r,n,o,i,h,p,f;return{c(){r=a("main"),n=a("h1"),o=u("Hello "),i=u(e[0]),h=u("!"),p=u(" "),f=a("p"),f.innerHTML='Visit the <a href="https://svelte.dev/tutorial">Svelte tutorial</a> to learn\n    how to build Svelte apps.',l(n,"class","svelte-1hoym3u"),l(r,"class","svelte-1hoym3u")},m(t,e){!function(t,e,r){t.insertBefore(e,r||null)}(t,r,e),s(r,n),s(n,o),s(n,i),s(n,h),s(r,p),s(r,f)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,t[0])},i:t,o:t,d(t){t&&c(r)}}}function M(t,e,r){let{name:n}=e;return t.$$set=t=>{"name"in t&&r(0,n=t.name)},[n]}class V{constructor({token:t,priority:e=0,oneArgument:r=!1,view:n,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=r,this.calc=o,n)this.view=n;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const n=e?t[0]:t;this.view=r?t=>`${t}${n}`:(t,e)=>`${t} ${n} ${e}`}}}var R=new V({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),O=new V({token:"+",calc:(t,e)=>t+e}),j=new V({token:"-",calc:(t,e)=>t-e}),B=new V({token:"*",priority:5,calc:(t,e)=>t*e}),N=new V({token:"/",priority:5,calc:(t,e)=>t/e}),T=new V({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),q=new V({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const D=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*D(t-1)};var C=new V({token:"!",priority:10,oneArgument:!0,calc:D,view:t=>`${t}!`});const F=[O,j,B,N,T,q,C];class H{constructor(t,e,r){if(this.operator=t,this.v1=e,this.v2=r,!t.oneArgument&&void 0===r){const e=Array.isArray(t.token)?t.token[0]:t.token;throw new Error(`Operator "${e}" require two arguments`)}}getMaxDepth(){const t=this.v1 instanceof H?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof H?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof H){const e=this.v1.operator.priority<this.operator.priority,r=this.v1.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof H){const e=this.v2.operator.priority<this.operator.priority,r=this.v2.view(t-1);return e&&t>1?`(${r})`:r}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const r=this.getV2View(t);return this.operator.view(e,r)}exec(){if(this.result)return this.result;const t=this.v1 instanceof H?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof H?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const I=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class L{constructor({operators:t=F}={}){this.operators=t}static getMatchRegex(t=[]){const e=[{matcher:t.reduce(((t,{token:e})=>t.concat(e)),[]).map(I).join("|"),name:"operator"},{matcher:L.numberRegexpString,name:"number"},{matcher:L.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(e,"g")}static validateBrackets(t){const e=t.match(new RegExp(L.bracketsRegexpString,"g"));if(!e)return!0;let r=0;return e.forEach((t=>{")"===t?r--:r++})),0===r}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=L.getMatchRegex(this.operators),r=[];let n=null,o=null,i=0;for(;n=e.exec(t);){const{number:t,bracket:e,operator:s}=n.groups;if(e)")"===e?i-=100:"("===e&&(o&&o.groups.number&&r.push({operator:B,priority:i+B.priority}),i+=100);else if(s){const t=this.getOperatorByToken(s);r.push({operator:t,priority:i+t.priority})}else if(t){const{groups:{bracket:e=null}={}}=o||{};")"===e&&r.push({operator:B,priority:i+B.priority}),r.push(parseFloat(t.replace(",",".")))}o=n}return r}compile(t=""){if(!L.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),r=e.filter((t=>"number"!=typeof t)),n=e.slice();if(r.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:r}=t,o=n.indexOf(t),i=n[o-1];if(e.oneArgument)n.splice(o-1,2,new H(e,i));else{const t=n[o+1];n.splice(o-1,3,new H(e,i,t))}})),n.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!n.length)throw new Error("No operators");const o=n[0];return"number"==typeof o?new H(R,o):o}calc(t=""){return this.compile(t).exec()}}L.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",L.bracketsRegexpString="[()]",window.Calculator=L,window.calc=new L;return new class extends class{$destroy(){!function(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),E(this,t,M,S,i,{name:0})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
