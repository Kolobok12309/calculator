var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function i(t){return null==t?"":t}function a(t,e){t.appendChild(e)}function l(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function p(){return f(" ")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}t.selectedIndex=-1}function v(t,e,n){t.classList[n?"add":"remove"](e)}let x;function w(t){x=t}function y(){const t=function(){if(!x)throw new Error("Function called outside component initialization");return x}();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}const b=[],k=[],_=[],E=[],A=Promise.resolve();let S=!1;function q(t){_.push(t)}let D=!1;const M=new Set;function j(){if(!D){D=!0;do{for(let t=0;t<b.length;t+=1){const e=b[t];w(e),L(e.$$)}for(w(null),b.length=0;k.length;)k.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];M.has(e)||(M.add(e),e())}_.length=0}while(b.length);for(;E.length;)E.pop()();S=!1,D=!1,M.clear()}}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(q)}}const V=new Set;function R(t,e){t&&t.i&&(V.delete(t),t.i(e))}function C(t,e,n,r){if(t&&t.o){if(V.has(t))return;V.add(t),undefined.c.push((()=>{V.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function O(t){t&&t.c()}function T(t,n,c,s){const{fragment:i,on_mount:a,on_destroy:l,after_update:u}=t.$$;i&&i.m(n,c),s||q((()=>{const n=a.map(e).filter(o);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(q)}function z(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(b.push(t),S||(S=!0,A.then(j)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(e,o,c,s,i,a,l,d=[-1]){const h=x;w(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||h.$$.root};l&&l(f.root);let p=!1;if(f.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&i(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&B(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!s&&s(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();o.intro&&R(e.$$.fragment),T(e,o.target,o.anchor,o.customElement),j()}w(h)}class I{$destroy(){z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const F=[];var H;!function(t){t.Dark="dark",t.Light="light",t.Default="default"}(H||(H={}));const P="color-theme",W=window.localStorage,G=(J=H,t=>Object.values(J).includes(t));var J;const K=(()=>{let e=H.Default;try{const t=W.getItem(P);G(t)&&(e=t)}catch(t){}const{subscribe:n,set:r}=function(e,n=t){let r;const o=new Set;function s(t){if(c(e,t)&&(e=t,r)){const t=!F.length;for(const t of o)t[1](),F.push(t,e);if(t){for(let t=0;t<F.length;t+=2)F[t][0](F[t+1]);F.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(c,i=t){const a=[c,i];return o.add(a),1===o.size&&(r=n(s)||t),c(e),()=>{o.delete(a),0===o.size&&(r(),r=null)}}}}(e,(t=>{const e=({storageArea:e,key:n,newValue:r})=>{e===W&&n===P&&G(r)&&t(r)};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}));return{subscribe:n,set:t=>{let e=H.Default;G(t)&&(e=t);try{W.setItem(P,e),r(e)}catch(t){}}}})();class Q{constructor({token:t,priority:e=0,oneArgument:n=!1,view:r,calc:o}={}){if(this.token=t,this.priority=e,this.oneArgument=n,this.calc=o,r)this.view=r;else{const e=Array.isArray(t);if(e&&!t.length)throw new Error("View is required for twoArgument operators without token");const r=e?t[0]:t;this.view=n?t=>`${t}${r}`:(t,e)=>`${t} ${r} ${e}`}}}var U=new Q({token:"empty",oneArgument:!0,view:t=>t,calc:t=>t}),X=new Q({token:"+",calc:(t,e)=>t+e}),Y=new Q({token:"-",calc:(t,e)=>t-e}),Z=new Q({token:"*",priority:5,calc:(t,e)=>t*e}),tt=new Q({token:"/",priority:5,calc:(t,e)=>t/e}),et=new Q({token:"^",priority:5,calc:(t,e)=>t**e,view:(t,e)=>`${t}^${e}`}),nt=new Q({token:"sqr",priority:5,oneArgument:!0,calc:t=>t*t});const rt=t=>{if(t<0)throw new Error("Negative value hasn't factorial");if(t%1)throw new Error("Fraction value hasn't factorial");return t>=0&&t<=2?t:t*rt(t-1)};var ot=new Q({token:"!",priority:10,oneArgument:!0,calc:rt,view:t=>`${t}!`});const ct=[X,Y,Z,tt,et,nt,ot];class st{constructor(t,e,n){if(this.operator=t,this.v1=e,this.v2=n,!t.oneArgument&&void 0===n)throw new Error(`Operator "${t.token}" require two arguments`)}getMaxDepth(){const t=this.v1 instanceof st?this.v1.getMaxDepth()+1:1,e=this.v2 instanceof st?this.v2.getMaxDepth()+1:1;return Math.max(t,e)}getV1View(t=1){if(0===t)return`${this.exec()}`;if(this.v1 instanceof st){const e=this.v1.operator.priority<this.operator.priority,n=this.v1.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v1}`}getV2View(t=1){if(0===t)return`${this.exec()}`;if(this.v2 instanceof st){const e=this.v2.operator.priority<this.operator.priority,n=this.v2.view(t-1);return e&&t>1?`(${n})`:n}return`${this.v2}`}view(t=1){if(t<0){const e=this.getMaxDepth();t=Math.max(e+1+t,0)}if(0===t)return`${this.exec()}`;const e=this.getV1View(t);if(this.operator.oneArgument)return this.operator.view(e);const n=this.getV2View(t);return this.operator.view(e,n)}exec(){if(this.result)return this.result;const t=this.v1 instanceof st?this.v1.exec():this.v1;if(this.operator.oneArgument)return this.result=this.operator.calc(t),this.result;const e=this.v2 instanceof st?this.v2.exec():this.v2;return this.result=this.operator.calc(t,e),this.result}}const it=(t="")=>t.replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&");class at{constructor({operators:t=ct}={}){this.operators=t}getMatchRegex(){const t=[{matcher:this.operators.reduce(((t,{token:e})=>t.concat(e)),[]).map(it).join("|"),name:"operator"},{matcher:at.numberRegexpString,name:"number"},{matcher:at.bracketsRegexpString,name:"bracket"}].map((({name:t,matcher:e})=>`(?<${t}>${e})`)).join("|");return new RegExp(t,"g")}static validateBrackets(t){const e=t.match(new RegExp(at.bracketsRegexpString,"g"));if(!e)return!0;let n=0;return e.forEach((t=>{")"===t?n--:n++})),0===n}getOperatorByToken(t){return this.operators.find((e=>"string"==typeof e.token?e.token===t:e.token.includes(t)))}parseString(t){const e=((t,e)=>{const n=[];let r;for(;r=t.exec(e);)n.push(r);return n})(this.getMatchRegex(),t),n=[];let r=0;return e.forEach((({groups:t},o)=>{const{number:c,bracket:s,operator:i}=t,a=e[o-1],l=e[o+1];if(s)")"===s?r-=100:"("===s&&(a&&a.groups.number&&n.push({operator:Z,priority:r+Z.priority}),r+=100);else if(i)if("+"!==i&&"-"!==i||a&&!(a&&a.groups.operator&&l&&l.groups.number)){const t=this.getOperatorByToken(i);n.push({operator:t,priority:r+t.priority})}else l.groups.number=`${i}${l.groups.number}`;else if(c){const{groups:{bracket:t=null}={}}=a||{};")"===t&&n.push({operator:Z,priority:r+Z.priority}),n.push(parseFloat(c.replace(",",".")))}})),n}compile(t=""){if(!at.validateBrackets(t))throw new Error("Invalid brackets");const e=this.parseString(t),n=e.filter((t=>"number"!=typeof t)),r=e.slice();if(n.sort(((t,e)=>e.priority-t.priority)).forEach((t=>{const{operator:e,priority:n}=t,o=r.indexOf(t),c=r[o-1];if(c&&"number"!=typeof c&&!(c instanceof st)){const{operator:{token:t}}=c;throw new Error(`Two operators in a row 1:"${t}", 2:"${e.token}"`)}if(e.oneArgument)r.splice(o-1,2,new st(e,c));else{const t=r[o+1];if(t&&"number"!=typeof t&&!(t instanceof st)){const{operator:{token:n}}=t;throw new Error(`Two operators in a row 1:"${e.token}", 2:"${n}"`)}r.splice(o-1,3,new st(e,c,t))}})),r.length>1)throw new Error('Wrong arguments location with "oneArgument" operators');if(!r.length)throw new Error("No operators");const o=r[0];return"number"==typeof o?new st(U,o):o}calc(t=""){return this.compile(t).exec()}}function lt(t,e,n){const r=t.slice();return r[2]=e[n],r}function ut(t){let e,n,r,o,c,s,d=t[2].text+"";return{c(){e=h("button"),n=f(d),r=p(),m(e,"class",o=i(`keyboard__btn keyboard__btn_${t[2].color}`)+" svelte-1jp43x7"),v(e,"keyboard__btn_round",t[2].round)},m(o,i){l(o,e,i),a(e,n),a(e,r),c||(s=g(e,"click",t[2].handler),c=!0)},p(e,n){t=e},d(t){t&&u(e),c=!1,s()}}}function dt(e){let n,r=e[0],o=[];for(let t=0;t<r.length;t+=1)o[t]=ut(lt(e,r,t));return{c(){n=h("div");for(let t=0;t<o.length;t+=1)o[t].c();m(n,"class","keyboard svelte-1jp43x7")},m(t,e){l(t,n,e);for(let t=0;t<o.length;t+=1)o[t].m(n,null)},p(t,[e]){if(1&e){let c;for(r=t[0],c=0;c<r.length;c+=1){const s=lt(t,r,c);o[c]?o[c].p(s,e):(o[c]=ut(s),o[c].c(),o[c].m(n,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:t,o:t,d(t){t&&u(n),d(o,t)}}}function ht(t){const e=y();return[[{text:"C",color:"red",handler:()=>e("reset")},{text:"CA",color:"red",handler:()=>e("reset")},{text:"â†",color:"red",handler:()=>e("backspace")},{text:"_",color:"red",handler:()=>e("add"," ")},{text:"(",color:"accent",handler:()=>e("add","(")},{text:")",color:"accent",handler:()=>e("add",")")},{text:"!",color:"accent",handler:()=>e("add","!")},{text:"/",color:"accent",handler:()=>e("add"," / ")},{text:"7",color:"text",handler:()=>e("add","7")},{text:"8",color:"text",handler:()=>e("add","8")},{text:"9",color:"text",handler:()=>e("add","9")},{text:"*",color:"accent",handler:()=>e("add"," * ")},{text:"4",color:"text",handler:()=>e("add","4")},{text:"5",color:"text",handler:()=>e("add","5")},{text:"6",color:"text",handler:()=>e("add","6")},{text:"-",color:"accent",handler:()=>e("add","-")},{text:"1",color:"text",handler:()=>e("add","1")},{text:"2",color:"text",handler:()=>e("add","2")},{text:"3",color:"text",handler:()=>e("add","3")},{text:"+",color:"accent",handler:()=>e("add","+")},{text:"0",color:"text",handler:()=>e("add","0")},{text:"000",color:"text",handler:()=>e("add","000")},{text:".",color:"text",handler:()=>e("add",".")},{text:"=",color:"bg",round:!0,handler:()=>e("submit")}]]}at.numberRegexpString="(?:[-+])?\\d+(?:[,.]\\d+)?",at.bracketsRegexpString="[()]";class ft extends I{constructor(t){super(),N(this,t,ht,dt,c,{})}}function pt(t,e,n){const r=t.slice();return r[4]=e[n],r}function gt(e){let n,r,o,c,s=e[4].label+"";return{c(){n=h("option"),r=f(s),o=p(),n.__value=c=e[4].id,n.value=n.__value,m(n,"class","theme-changer__option")},m(t,e){l(t,n,e),a(n,r),a(n,o)},p:t,d(t){t&&u(n)}}}function mt(e){let n,r,o,c,s,f,v,x,w=e[2],y=[];for(let t=0;t<w.length;t+=1)y[t]=gt(pt(e,w,t));return{c(){n=h("div"),r=h("i"),s=p(),f=h("select");for(let t=0;t<y.length;t+=1)y[t].c();m(r,"class",o=i(`fas theme-changer__icon fa-${e[1].icon}`)+" svelte-lru31z"),m(r,"title",c=e[1].label),m(f,"aria-label","Color theme select"),m(f,"class","theme-changer__select svelte-lru31z"),void 0===e[0]&&q((()=>e[3].call(f))),m(n,"class","theme-changer svelte-lru31z")},m(t,o){l(t,n,o),a(n,r),a(n,s),a(n,f);for(let t=0;t<y.length;t+=1)y[t].m(f,null);$(f,e[0]),v||(x=g(f,"change",e[3]),v=!0)},p(t,[e]){if(2&e&&o!==(o=i(`fas theme-changer__icon fa-${t[1].icon}`)+" svelte-lru31z")&&m(r,"class",o),2&e&&c!==(c=t[1].label)&&m(r,"title",c),4&e){let n;for(w=t[2],n=0;n<w.length;n+=1){const r=pt(t,w,n);y[n]?y[n].p(r,e):(y[n]=gt(r),y[n].c(),y[n].m(f,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=w.length}5&e&&$(f,t[0])},i:t,o:t,d(t){t&&u(n),d(y,t),v=!1,x()}}}function $t(t,e,n){let r,o;s(t,K,(t=>n(0,o=t)));const c=[{id:H.Light,label:"Light",icon:"sun"},{id:H.Dark,label:"Dark",icon:"moon"},{id:H.Default,label:"System",icon:"adjust"}];return t.$$.update=()=>{1&t.$$.dirty&&n(1,r=c.find((({id:t})=>t===o)))},[o,r,c,function(){o=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),K.set(o),n(2,c)}]}class vt extends I{constructor(t){super(),N(this,t,$t,mt,c,{})}}function xt(e){let n,r;return{c(){n=h("div"),r=f(e[0]),m(n,"class","display svelte-1wcxwyl")},m(t,e){l(t,n,e),a(n,r)},p(t,[e]){1&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(r,t[0])},i:t,o:t,d(t){t&&u(n)}}}function wt(t,e,n){let{result:r=0}=e;return t.$$set=t=>{"result"in t&&n(0,r=t.result)},[r]}class yt extends I{constructor(t){super(),N(this,t,wt,xt,c,{result:0})}}function bt(e){let n;return{c(){n=h("div"),m(n,"class","display svelte-1jdoecx")},m(t,r){l(t,n,r),n.innerHTML=e[0]},p(t,[e]){1&e&&(n.innerHTML=t[0])},i:t,o:t,d(t){t&&u(n)}}}function kt(t,e,n){let r,{query:o=""}=e;const c=(t,e="")=>`<span class="display__${t}">${e}</span>`;return t.$$set=t=>{"query"in t&&n(1,o=t.query)},t.$$.update=()=>{2&t.$$.dirty&&n(0,r=o.replace(/ +/g,c("space")).replace(/\d+/g,(t=>c("num",t))))},[r,o]}class _t extends I{constructor(t){super(),N(this,t,kt,bt,c,{query:1})}}function Et(t){let e,n,r,o,c,s,i,d,f,g,$,v,x;return r=new vt({}),s=new yt({props:{result:t[0]}}),f=new _t({props:{query:t[1]}}),v=new ft({}),v.$on("add",t[2]),v.$on("backspace",t[3]),v.$on("reset",t[4]),v.$on("submit",t[5]),{c(){e=h("main"),n=h("div"),O(r.$$.fragment),o=p(),c=h("div"),O(s.$$.fragment),i=p(),d=h("div"),O(f.$$.fragment),g=p(),$=h("div"),O(v.$$.fragment),m(n,"class","calculator__settings svelte-1t40vum"),m(c,"class","calculator__result"),m(d,"class","calculator__query"),m($,"class","calculator__keyboard svelte-1t40vum"),m(e,"class","calculator svelte-1t40vum")},m(t,u){l(t,e,u),a(e,n),T(r,n,null),a(e,o),a(e,c),T(s,c,null),a(e,i),a(e,d),T(f,d,null),a(e,g),a(e,$),T(v,$,null),x=!0},p(t,[e]){const n={};1&e&&(n.result=t[0]),s.$set(n);const r={};2&e&&(r.query=t[1]),f.$set(r)},i(t){x||(R(r.$$.fragment,t),R(s.$$.fragment,t),R(f.$$.fragment,t),R(v.$$.fragment,t),x=!0)},o(t){C(r.$$.fragment,t),C(s.$$.fragment,t),C(f.$$.fragment,t),C(v.$$.fragment,t),x=!1},d(t){t&&u(e),z(r),z(s),z(f),z(v)}}}const At=new at;function St(t,e,n){let r=0,o=null,c="";return[r,c,({detail:t})=>{n(1,c+=t)},()=>{n(1,c=c.slice(0,-1))},()=>{n(1,c=""),n(0,r=0),o=null},()=>{try{o=At.compile(c),n(0,r=o.exec()),n(1,c=o.view(-1))}catch(t){console.error(t)}}]}class qt extends I{constructor(t){super(),N(this,t,St,Et,c,{})}}function Dt(t){let e,n,r;return n=new qt({}),{c(){e=h("div"),O(n.$$.fragment),m(e,"class","container svelte-yay42w"),v(e,"dark","dark"===t[0]),v(e,"light","light"===t[0])},m(t,o){l(t,e,o),T(n,e,null),r=!0},p(t,[n]){1&n&&v(e,"dark","dark"===t[0]),1&n&&v(e,"light","light"===t[0])},i(t){r||(R(n.$$.fragment,t),r=!0)},o(t){C(n.$$.fragment,t),r=!1},d(t){t&&u(e),z(n)}}}function Mt(t,e,n){let r;return s(t,K,(t=>n(0,r=t))),[r]}const jt=new class extends I{constructor(t){super(),N(this,t,Mt,Dt,c,{})}}({target:document.body});return window.Calculator=at,window.calc=new at,jt}();
//# sourceMappingURL=bundle.js.map
